import{r as e,c as l,B as a,z as s,E as t,K as i,J as n,ah as u,C as o,D as r,ak as v,G as c,M as d,O as p,P as m,a4 as f,u as g,n as y}from"./vue-vendor-CYJ4K8iR.js";import{E as h,l as k,p as w,n as b,o as _,s as C,q as x,t as D,w as z}from"./element-plus-dcQV5w3x.js";import{Q as V}from"./browser-Dvgp9tZk.js";import{_ as j}from"./index-CT3p-j8z.js";import"./qrcode-DA2KNt05.js";import"./mermaid-BoZA0hCz.js";const U={class:"tool-container"},L={key:0,class:"quick-section"},M={key:0,class:"drop-overlay"},S={class:"image-section"},q={class:"image-header"},B={class:"image-title"},O={key:0,class:"size-info"},R={key:0,class:"image-grid"},P=["src"],T={class:"image-overlay"},J={class:"quick-actions"},I={key:1,class:"create-section"},N={class:"panel-header"},W={key:0,class:"drop-overlay"},A={class:"image-section"},E={class:"image-header"},F={class:"image-title"},G={key:0,class:"size-info"},Q={key:0,class:"image-grid"},$=["src"],H={class:"image-overlay"},K={class:"options-row"},X={class:"option-item"},Y={class:"option-item"},Z={class:"option-item"},ee={key:2,class:"result-section"},le={class:"result-card"},ae={class:"result-header"},se={class:"share-url-box"},te={class:"url-display"},ie={class:"url-actions"},ne={class:"qr-section"},ue={class:"result-info"},oe={key:0},re={key:3,class:"error-msg"},ve={key:4,class:"tips-section"},ce=31457280,de=j({__name:"PasteBin",setup(j){const de=e(""),pe=e(""),me=e("text"),fe=e(24),ge=e(100),ye=e(""),he=e(!1),ke=e(!1),we=e(!1),be=e(""),_e=e(""),Ce=e(""),xe=e(""),De=e(null),ze=e([]),Ve=e(null),je=e(!1),Ue=l(()=>{let e=de.value.length;for(const l of ze.value)e+=l.base64.length;return e}),Le=l(()=>(Ue.value/1024/1024).toFixed(2)),Me=l(()=>ze.value.length<15&&Ue.value<ce),Se=async()=>{await Ae()},qe=async e=>{const l=e.clipboardData?.items;if(l)for(const s of l)if(s.type.startsWith("image/")){e.preventDefault();const l=s.getAsFile();return void(l&&await Be(l))}const a=e.clipboardData?.getData("text")||"";if(a.trim().startsWith("{")||a.trim().startsWith("["))try{JSON.parse(a),me.value="json"}catch{}},Be=async e=>{if(!e.type.startsWith("image/"))return void h.warning("只支持图片文件");if(ze.value.length>=15)return void h.warning("最多只能上传 15 张图片");const l=await Oe(e);Ue.value+l.length>ce?h.warning("总大小超过 30MB 限制"):ze.value.push({file:e,preview:URL.createObjectURL(e),base64:l})},Oe=e=>new Promise(l=>{const a=new FileReader;a.onload=()=>l(a.result),a.readAsDataURL(e)}),Re=e=>{const l=ze.value[e];l.preview&&URL.revokeObjectURL(l.preview),ze.value.splice(e,1)},Pe=()=>{Ve.value?.click()},Te=async e=>{const l=e.target.files;for(const a of l)await Be(a);e.target.value=""},Je=e=>{e.preventDefault(),je.value=!0},Ie=e=>{e.preventDefault(),je.value=!1},Ne=e=>{e.preventDefault()},We=async e=>{e.preventDefault(),je.value=!1;const l=e.dataTransfer?.files;if(l)for(const a of l)await Be(a)},Ae=async()=>{if(de.value.trim()||0!==ze.value.length){he.value=!0,xe.value="";try{const e=await fetch("/api/paste",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:de.value,title:pe.value,language:me.value,expires_in:fe.value,max_views:ge.value,password:ye.value,images:ze.value.map(e=>e.base64)})}),l=await e.json();if(!e.ok)throw new Error(l.error||"创建失败");be.value=l.id,_e.value=new Date(l.expires_at).toLocaleString("zh-CN"),Ce.value=`${window.location.origin}/paste/${l.id}`,ke.value=!0;try{await navigator.clipboard.writeText(Ce.value),h.success("链接已自动复制到剪贴板")}catch{h.success("分享创建成功")}await y(),De.value&&V.toCanvas(De.value,Ce.value,{width:150,margin:2,color:{dark:"#333",light:"#fff"}})}catch(e){xe.value=e.message}finally{he.value=!1}}else xe.value="请输入内容或上传图片"},Ee=async()=>{try{await navigator.clipboard.writeText(Ce.value),h.success("链接已复制")}catch(e){h.error("复制失败")}},Fe=()=>{window.open(Ce.value,"_blank")},Ge=()=>{de.value="",pe.value="",ye.value="",ke.value=!1,be.value="";for(const e of ze.value)e.preview&&URL.revokeObjectURL(e.preview);ze.value=[]};return(e,l)=>{const y=v("el-icon"),h=v("el-button"),V=v("el-input"),j=v("el-option"),ce=v("el-select"),Ue=v("el-input-number"),Be=v("el-alert");return s(),a("div",U,[l[30]||(l[30]=t("div",{class:"tool-header"},[t("h2",null,"共享粘贴板"),t("div",{class:"info-text"}," 多设备快速同步 - 创建后自动复制链接 ")],-1)),we.value?(s(),a("div",I,[t("div",{class:c(["editor-panel",{"is-dragging":je.value}]),onDragenter:Je,onDragleave:Ie,onDragover:Ne,onDrop:We},[t("div",N,[o(V,{modelValue:pe.value,"onUpdate:modelValue":l[2]||(l[2]=e=>pe.value=e),placeholder:"标题（可选）",style:{width:"200px"},size:"small"},null,8,["modelValue"]),o(ce,{modelValue:me.value,"onUpdate:modelValue":l[3]||(l[3]=e=>me.value=e),placeholder:"语言",style:{width:"120px"},size:"small"},{default:r(()=>[o(j,{label:"纯文本",value:"text"}),o(j,{label:"JSON",value:"json"}),o(j,{label:"JavaScript",value:"javascript"}),o(j,{label:"TypeScript",value:"typescript"}),o(j,{label:"Python",value:"python"}),o(j,{label:"Go",value:"go"}),o(j,{label:"Java",value:"java"}),o(j,{label:"C/C++",value:"cpp"}),o(j,{label:"HTML",value:"html"}),o(j,{label:"CSS",value:"css"}),o(j,{label:"SQL",value:"sql"}),o(j,{label:"Markdown",value:"markdown"}),o(j,{label:"Shell",value:"bash"}),o(j,{label:"YAML",value:"yaml"}),o(j,{label:"XML",value:"xml"})]),_:1},8,["modelValue"]),o(h,{size:"small",text:"",onClick:l[4]||(l[4]=e=>we.value=!1)},{default:r(()=>[...l[15]||(l[15]=[d("简洁模式",-1)])]),_:1})]),n(t("textarea",{"onUpdate:modelValue":l[5]||(l[5]=e=>de.value=e),class:"code-editor",placeholder:"在此输入要分享的内容...",spellcheck:"false",onPaste:qe},null,544),[[u,de.value]]),je.value?(s(),a("div",W,[o(y,{size:48},{default:r(()=>[o(g(k))]),_:1}),l[16]||(l[16]=t("span",null,"拖放图片到此处",-1))])):i("",!0)],34),t("div",A,[t("div",E,[t("span",F,[o(y,null,{default:r(()=>[o(g(w))]),_:1}),d(" 图片分享 ("+p(ze.value.length)+"/"+p(15)+") ",1)]),ze.value.length>0?(s(),a("span",G," 总大小: "+p(Le.value)+" MB / 30 MB ",1)):i("",!0)]),ze.value.length>0?(s(),a("div",Q,[(s(!0),a(m,null,f(ze.value,(e,l)=>(s(),a("div",{class:"image-item",key:l},[t("img",{src:e.preview,alt:"预览"},null,8,$),t("div",H,[o(h,{type:"danger",circle:"",size:"small",onClick:e=>Re(l)},{default:r(()=>[o(y,null,{default:r(()=>[o(g(b))]),_:1})]),_:1},8,["onClick"])])]))),128)),Me.value?(s(),a("div",{key:0,class:"image-add",onClick:Pe},[o(y,{size:24},{default:r(()=>[o(g(_))]),_:1}),l[17]||(l[17]=t("span",null,"添加图片",-1))])):i("",!0)])):(s(),a("div",{key:1,class:"image-upload",onClick:Pe},[o(y,{size:32},{default:r(()=>[o(g(w))]),_:1}),l[18]||(l[18]=t("span",null,"点击上传图片或直接粘贴/拖拽",-1)),l[19]||(l[19]=t("span",{class:"upload-hint"},"最多 15 张，总大小不超过 30MB",-1))])),t("input",{ref_key:"fileInput",ref:Ve,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:Te},null,544)]),t("div",K,[t("div",X,[l[20]||(l[20]=t("span",{class:"option-label"},"过期时间",-1)),o(ce,{modelValue:fe.value,"onUpdate:modelValue":l[6]||(l[6]=e=>fe.value=e),style:{width:"120px"}},{default:r(()=>[o(j,{label:"1 小时",value:1}),o(j,{label:"6 小时",value:6}),o(j,{label:"24 小时",value:24}),o(j,{label:"3 天",value:72}),o(j,{label:"7 天",value:168})]),_:1},8,["modelValue"])]),t("div",Y,[l[21]||(l[21]=t("span",{class:"option-label"},"最大访问次数",-1)),o(Ue,{modelValue:ge.value,"onUpdate:modelValue":l[7]||(l[7]=e=>ge.value=e),min:1,max:1e3},null,8,["modelValue"])]),t("div",Z,[l[22]||(l[22]=t("span",{class:"option-label"},"访问密码",-1)),o(V,{modelValue:ye.value,"onUpdate:modelValue":l[8]||(l[8]=e=>ye.value=e),type:"password",placeholder:"可选",style:{width:"150px"},"show-password":""},null,8,["modelValue"])]),o(h,{type:"primary",size:"large",onClick:Ae,loading:he.value,disabled:!de.value.trim()&&0===ze.value.length},{default:r(()=>[...l[23]||(l[23]=[d(" 创建分享 ",-1)])]),_:1},8,["loading","disabled"])])])):(s(),a("div",L,[t("div",{class:c(["quick-editor",{"is-dragging":je.value}]),onDragenter:Je,onDragleave:Ie,onDragover:Ne,onDrop:We},[n(t("textarea",{"onUpdate:modelValue":l[0]||(l[0]=e=>de.value=e),class:"code-editor",placeholder:"粘贴或输入内容/图片，点击分享即可获得链接...",spellcheck:"false",onPaste:qe},null,544),[[u,de.value]]),je.value?(s(),a("div",M,[o(y,{size:48},{default:r(()=>[o(g(k))]),_:1}),l[9]||(l[9]=t("span",null,"拖放图片到此处",-1))])):i("",!0)],34),t("div",S,[t("div",q,[t("span",B,[o(y,null,{default:r(()=>[o(g(w))]),_:1}),d(" 图片分享 ("+p(ze.value.length)+"/"+p(15)+") ",1)]),ze.value.length>0?(s(),a("span",O," 总大小: "+p(Le.value)+" MB / 30 MB ",1)):i("",!0)]),ze.value.length>0?(s(),a("div",R,[(s(!0),a(m,null,f(ze.value,(e,l)=>(s(),a("div",{class:"image-item",key:l},[t("img",{src:e.preview,alt:"预览"},null,8,P),t("div",T,[o(h,{type:"danger",circle:"",size:"small",onClick:e=>Re(l)},{default:r(()=>[o(y,null,{default:r(()=>[o(g(b))]),_:1})]),_:1},8,["onClick"])])]))),128)),Me.value?(s(),a("div",{key:0,class:"image-add",onClick:Pe},[o(y,{size:24},{default:r(()=>[o(g(_))]),_:1}),l[10]||(l[10]=t("span",null,"添加图片",-1))])):i("",!0)])):(s(),a("div",{key:1,class:"image-upload",onClick:Pe},[o(y,{size:32},{default:r(()=>[o(g(w))]),_:1}),l[11]||(l[11]=t("span",null,"点击上传图片或直接粘贴/拖拽",-1)),l[12]||(l[12]=t("span",{class:"upload-hint"},"最多 15 张，总大小不超过 30MB",-1))])),t("input",{ref_key:"fileInput",ref:Ve,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:Te},null,544)]),t("div",J,[o(h,{type:"primary",size:"large",onClick:Se,loading:he.value,disabled:!de.value.trim()&&0===ze.value.length},{default:r(()=>[o(y,null,{default:r(()=>[o(g(C))]),_:1}),l[13]||(l[13]=d(" 一键分享 ",-1))]),_:1},8,["loading","disabled"]),o(h,{size:"small",text:"",onClick:l[1]||(l[1]=e=>we.value=!0)},{default:r(()=>[...l[14]||(l[14]=[d(" 高级选项 ",-1)])]),_:1})])])),ke.value?(s(),a("div",ee,[t("div",le,[t("div",ae,[o(y,{class:"success-icon"},{default:r(()=>[o(g(x))]),_:1}),l[24]||(l[24]=t("span",null,"分享创建成功！链接已复制",-1))]),t("div",se,[t("div",te,p(Ce.value),1),t("div",ie,[o(h,{type:"primary",onClick:Ee},{default:r(()=>[o(y,null,{default:r(()=>[o(g(D))]),_:1}),l[25]||(l[25]=d(" 复制链接 ",-1))]),_:1}),o(h,{onClick:Fe},{default:r(()=>[o(y,null,{default:r(()=>[o(g(z))]),_:1}),l[26]||(l[26]=d(" 打开 ",-1))]),_:1})])]),t("div",ne,[l[27]||(l[27]=t("div",{class:"qr-title"},"扫码访问",-1)),t("canvas",{ref_key:"qrCanvas",ref:De,class:"qr-code"},null,512)]),t("div",ue,[t("span",null,"ID: "+p(be.value),1),t("span",null,"过期: "+p(_e.value),1),ye.value?(s(),a("span",oe,"密码: "+p(ye.value),1)):i("",!0)]),o(h,{class:"new-share-btn",onClick:Ge,type:"success",plain:""},{default:r(()=>[o(y,null,{default:r(()=>[o(g(_))]),_:1}),l[28]||(l[28]=d(" 创建新分享 ",-1))]),_:1})])])):i("",!0),xe.value?(s(),a("div",re,[o(Be,{title:xe.value,type:"error","show-icon":"",closable:!1},null,8,["title"])])):i("",!0),ke.value?i("",!0):(s(),a("div",ve,[...l[29]||(l[29]=[t("h4",null,"使用提示",-1),t("ul",null,[t("li",null,"直接粘贴内容，点击分享即可"),t("li",null,"链接自动复制到剪贴板"),t("li",null,"手机可扫描二维码访问"),t("li",null,"默认 24 小时后过期")],-1)])]))])}}},[["__scopeId","data-v-8312e418"]]);export{de as default};
